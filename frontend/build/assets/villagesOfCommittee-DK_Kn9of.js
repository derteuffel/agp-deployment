import{d as y,o as b,j as e,D as n,F as r,x as c,n as u,U as v,r as x,V as C,W as S,b as w,X as L,y as A}from"./index-BBwNWda_.js";function k({show:o,handleClose:d}){var m;const t=y(),{register:a,handleSubmit:l,reset:h,formState:{errors:j,isSubmitting:s}}=b({defaultValues:{name:""}}),i=async f=>{const p=u.loading("Ajout en cours...");try{await t(v(f)).unwrap(),u.update(p,{render:"Profession ajoutée",type:"success",isLoading:!1,autoClose:2e3}),h(),d()}catch{u.update(p,{render:"Erreur",type:"error",isLoading:!1,autoClose:2e3})}};return e.jsxs(n,{show:o,onHide:d,centered:!0,children:[e.jsx(n.Header,{closeButton:!0,children:e.jsx(n.Title,{children:"Ajouter une profession"})}),e.jsx(n.Body,{children:e.jsxs(r,{onSubmit:l(i),children:[e.jsxs(r.Group,{children:[e.jsx(r.Label,{children:"Nom"}),e.jsx(r.Control,{...a("name",{required:"Le nom est requis"}),isInvalid:!!j.name}),e.jsx(r.Control.Feedback,{type:"invalid",children:(m=j.name)==null?void 0:m.message})]}),e.jsxs("div",{className:"mt-3 d-flex justify-content-end",children:[e.jsx(c,{variant:"secondary",onClick:d,className:"me-2",children:"Annuler"}),e.jsx(c,{type:"submit",disabled:s,children:s?"Ajout...":"Ajouter"})]})]})})]})}function N({profession:o}){var f;const[d,t]=x.useState(!1),a=y(),{register:l,handleSubmit:h,reset:j,formState:{errors:s,isSubmitting:i}}=b({defaultValues:{name:o.name}}),m=async p=>{const g=u.loading("Mise à jour...");try{await a(C({id:o.id,data:p})).unwrap(),u.update(g,{render:"Profession modifiée",type:"success",isLoading:!1,autoClose:2e3}),j(),t(!1)}catch{u.update(g,{render:"Erreur",type:"error",isLoading:!1,autoClose:2e3})}};return o?e.jsxs(e.Fragment,{children:[e.jsx(c,{variant:"warning",size:"sm",onClick:()=>t(!0),children:"Modifier"}),e.jsxs(n,{show:d,onHide:()=>t(!1),centered:!0,children:[e.jsx(n.Header,{closeButton:!0,children:e.jsx(n.Title,{children:"Modifier la profession"})}),e.jsx(n.Body,{children:e.jsxs(r,{onSubmit:h(m),children:[e.jsxs(r.Group,{children:[e.jsx(r.Label,{children:"Nom"}),e.jsx(r.Control,{...l("name",{required:"Le nom est requis"}),isInvalid:!!s.name}),e.jsx(r.Control.Feedback,{type:"invalid",children:(f=s.name)==null?void 0:f.message})]}),e.jsxs("div",{className:"mt-3 d-flex justify-content-end",children:[e.jsx(c,{variant:"secondary",onClick:()=>t(!1),className:"me-2",children:"Annuler"}),e.jsx(c,{type:"submit",disabled:i,children:i?"Mise à jour...":"Mettre à jour"})]})]})})]})]}):null}function P({id:o,name:d}){const[t,a]=x.useState(!1),[l,h]=x.useState(""),j=y(),s=async()=>{const i=u.loading("Suppression...");try{await j(S({id:o,reason:l})).unwrap(),u.update(i,{render:"Profession supprimée",type:"success",isLoading:!1,autoClose:2e3}),a(!1)}catch{u.update(i,{render:"Erreur",type:"error",isLoading:!1,autoClose:2e3})}};return e.jsxs(e.Fragment,{children:[e.jsx(c,{variant:"danger",size:"sm",onClick:()=>a(!0),children:"Supprimer"}),e.jsxs(n,{show:t,onHide:()=>a(!1),centered:!0,children:[e.jsx(n.Header,{closeButton:!0,children:e.jsx(n.Title,{children:"Supprimer la profession"})}),e.jsxs(n.Body,{children:[e.jsxs("p",{children:["Êtes-vous sûr de vouloir supprimer ",e.jsx("strong",{children:d})," ?"]}),e.jsxs(r.Group,{children:[e.jsx(r.Label,{children:"Motif"}),e.jsxs(r.Select,{value:l,onChange:i=>h(i.target.value),className:"shadow-sm",required:!0,children:[e.jsx("option",{value:"",children:"-- Choisir --"}),e.jsx("option",{value:"Bad data",children:"Données erronées"}),e.jsx("option",{value:"Data created by mistake and more",children:"Données créées par erreur"})]})]})]}),e.jsxs(n.Footer,{children:[e.jsx(c,{variant:"secondary",onClick:()=>a(!1),children:"Annuler"}),e.jsx(c,{variant:"danger",onClick:s,disabled:!l.trim(),children:"Confirmer"})]})]})]})}function F(){const o=y(),{professions:d}=w(s=>s.profession),[t,a]=x.useState(""),[l,h]=x.useState(!1);x.useEffect(()=>{o(L())},[o]);const j=d.filter(s=>s.name.toLowerCase().includes(t.toLowerCase()));return e.jsxs("div",{children:[e.jsxs("div",{className:"d-flex justify-content-between mb-3",children:[e.jsx(r.Control,{type:"text",placeholder:"Rechercher une profession",value:t,onChange:s=>a(s.target.value),style:{width:"30%"}}),e.jsx(c,{onClick:()=>h(!0),children:"Ajouter"})]}),e.jsxs(A,{striped:!0,bordered:!0,hover:!0,children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"#"}),e.jsx("th",{children:"Nom"}),e.jsx("th",{children:"Actions"})]})}),e.jsx("tbody",{children:j.map((s,i)=>e.jsxs("tr",{children:[e.jsx("td",{children:i+1}),e.jsx("td",{children:s.name}),e.jsxs("td",{className:"d-flex gap-2 justify-content-center",children:[e.jsx(N,{profession:s}),e.jsx(P,{id:s.id,name:s.name})]})]},s.id))})]}),e.jsx(k,{show:l,handleClose:()=>h(!1)})]})}export{F as default};
